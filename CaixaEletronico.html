<!doctype html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width-device-width, initial-scale=1.0">
    <title>Caixa Eletrônico</title>
    <script>
        usuarios = [
            { 
                name: 'JOSINEUDO ARRUDA', 
                agencia: 12349, 
                senha: 6666, 
                saldo: 10000
            },
            { 
                name: 'GABRIEL AUGUSTO', 
                agencia: 12347, 
                senha: 3589,
                saldo: 1
            },
            
        ]

        function estaVazio(string) {
            return string === "";
        }

        function cadastro() {
            var nome = "";
            while(nome == "") {
                nome = prompt("Insira seu nome para cadastro:");
                if (estaVazio(nome)) {
                    alert("Nome não pode estar vazio!");
                }
            }
            nome = nome.toLocaleUpperCase();
            var agencia = 0;
            while(agencia == "" || isNaN(agencia) || (agencia > 99999 || agencia < 10000) ) {
                agencia = prompt("Insira o seu número de agencia (cinco números):");
                if (agencia == "") {
                    alert("Agência não pode estar vazia!");
                }
                if (isNaN(agencia)) {
                    alert("Agência tem que ser um número!");
                }
                if (agencia > 99999 || agencia < 10000) {
                    alert("Agência tem que ser apenas 5 números!");
                }
            }
            var senha = 0;
            while(senha == "" || isNaN(senha) || (senha > 9999 || senha < 1000) ) {
                senha = prompt("Insira a sua senha (quatro números):");
                if (senha == "") {
                    alert("Agência não pode estar vazia!");
                }
                if (isNaN(senha)) {
                    alert("Agência tem que ser um número!");
                }
                if (senha > 9999 || senha < 1000) {
                    alert("Agência tem que ser apenas 4 números!");
                }
            }
            user = {
                name: nome,
                agencia: agencia,
                senha: senha,
                saldo: 1000
            }
            usuarios.push(user);
        }

        function estaCadastrado(string) {
            if(usuarios.some(usuario => usuario.name === string)) {
                return true;
            } else {
                var resposta = 0;
                while(resposta !== 1 && resposta !== 2)
                resposta = parseInt(prompt("Usuário não cadastrado!\nDeseja se cadastrar?\n1- SIM\n2- NÃO"));
                switch(resposta) {
                    case 1:
                        cadastro();
                        return true;
                    case 2:
                        return false;
                    default: 
                        alert("Valor inserido incorreto. Tente novamente!");
                        return false;
                }
            }
        }

        var end = false;
        while(!end) {
            var nome = "";
            while(nome == "" || !(estaCadastrado(nome))) {
                nome = prompt("--------------------------------------------------------\n     SEJA BEM-VINDO AO CAIXA ELETRÔNICO     \n--------------------------------------------------------\nInsira seu nome Cadastrado:");
                estaVazio(nome);
                nome = nome.toLocaleUpperCase();
            }
            alert("Bem vindo "+nome+"\nClique em 'OK' para continuar");
            var resposta = '';
            var dados_user = usuarios.some(user => user.name === nome);
            while(resposta == '') {
                resposta = prompt("--------------------------------------------------------\n             CAIXA ELETRÔNICO     \n--------------------------------------------------------\nDados:\n--------------------------------------------------------\nNome: "+dados_user.name+"");
            }


            end = confirm("Deseja sair?");
        }
    </script>
  </head>
  <body>
  </body>
</html>